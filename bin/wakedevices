#!/usr/bin/env bash
#
# Keeps all adb devices awake while running

echo "Waking devices..."

while true
do
    while read line <&3
    do
        device_id=$(echo $line | cut -d' ' -f1)
        echo "Waking ${device_id}..."
        ~/Library/Android/sdk/platform-tools/adb -s ${device_id} shell input keyevent KEYCODE_WAKEUP
        ~/Library/Android/sdk/platform-tools/adb -s ${device_id} shell input keyevent mouse
    done 3< <(~/Library/Android/sdk/platform-tools/adb devices | grep -v 'List of devices attached' | grep .)

    sleep 15
done
